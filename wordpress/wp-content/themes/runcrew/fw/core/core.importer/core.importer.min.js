jQuery(document).ready(function(){jQuery(".trx_importer_section").on("click",'.trx_buttons input[type="button"]',function(){var c=jQuery(this).data("last_id");if(!c){c=0}var d=jQuery(this).data("last_slider");if(!d){d=0}var b=[];var a="";var e=jQuery('#trx_importer_form [name="demo_type"]:checked').val();jQuery(this).parents("form").find('input[type="checkbox"]').each(function(){var f=jQuery(this).attr("name");if(jQuery(this).get(0).checked){a+=(a?",":"")+f.substr(7);var g={action:f,data:{demo_type:e}};if(f=="import_posts"){g.data.last_id=c}b.push(g)}else{jQuery("#trx_importer_progress ."+f).hide()}});b.unshift({action:"import_start",data:{clear_tables:a,demo_type:e}});b.push({action:"import_end",data:{demo_type:e}});jQuery("#trx_importer_form").hide();jQuery("#trx_importer_progress").fadeIn();RUNCREW_STORAGE.importer_error_messages="";RUNCREW_STORAGE.importer_ignore_errors=true;runcrew_importer_do_action(b,0)})});function runcrew_importer_do_action(b,a){if(!jQuery("#trx_importer_progress ."+b[a].action+" .import_progress_status").hasClass("step_in_progress")){jQuery("#trx_importer_progress ."+b[a].action+" .import_progress_status").addClass("step_in_progress").html("0%")}var d={ajax_nonce:RUNCREW_STORAGE.ajax_nonce,action:"runcrew_importer_start_import",importer_action:b[a].action};for(var c in b[a].data){d[c]=b[a].data[c]}jQuery.post(RUNCREW_STORAGE.ajax_url,d,function(f){var i={};try{i=JSON.parse(f)}catch(h){i={error:RUNCREW_STORAGE.ajax_error+":<br>"+f};console.log(f)}if(i.error===""||RUNCREW_STORAGE.importer_ignore_errors){if(i.error!==""){RUNCREW_STORAGE.importer_error_messages+='<p class="error_message">'+i.error+"</p>"}var g=i.action;if(i.result>=100){jQuery("#trx_importer_progress ."+g+" .import_progress_status").html("");jQuery("#trx_importer_progress ."+g+" .import_progress_status").removeClass("step_in_progress").addClass("step_complete"+(i.error?" step_complete_with_error":""));a++}else{jQuery("#trx_importer_progress ."+g+" .import_progress_status").html(i.result+"%");if(typeof b[a].data.last_id!="undefined"){b[a].data.last_id++}b[a].data.attempt=(typeof i.attempt!="undefined")?i.attempt:0}if(a<b.length){runcrew_importer_do_action(b,a)}else{if(RUNCREW_STORAGE.importer_error_messages){jQuery("#trx_importer_progress").removeClass("notice-info").addClass("notice-error").append("<h4>"+RUNCREW_STORAGE.importer_error_msg+"</h4>"+RUNCREW_STORAGE.importer_error_messages)}else{jQuery("#trx_importer_progress").removeClass("notice-info").addClass("notice-success");jQuery(".trx_importer_progress_complete").show()}}}else{jQuery("#trx_importer_progress").removeClass("notice-info").addClass("notice-error").css({paddingTop:"1em",paddingBottom:"1em"}).html(i.error)}})};